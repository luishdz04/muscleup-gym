2025-06-19 14:02:00,454 [INFO] ================================================================================
2025-06-19 14:02:00,454 [INFO] ğŸš€ SERVICIO UNIFICADO F22 - REGISTRO Y CONTROL DE ACCESO
2025-06-19 14:02:00,454 [INFO] ================================================================================
2025-06-19 14:02:00,455 [INFO] ğŸ“… VersiÃ³n: 3.0.0 FIXED - 2025-06-19 14:02:00.455009
2025-06-19 14:02:00,455 [INFO] ğŸ‘¤ Autor: luishdz04
2025-06-19 14:02:00,455 [INFO] ğŸŒ Puerto WebSocket: 8082
2025-06-19 14:02:00,455 [INFO] ğŸ¢ Dispositivo: 192.168.1.201:4370
2025-06-19 14:02:00,457 [INFO] ğŸŒ Zona horaria: America/Mexico_City
2025-06-19 14:02:00,458 [INFO] 
2025-06-19 14:02:00,458 [INFO] âœ… CARACTERÃSTICAS:
2025-06-19 14:02:00,458 [INFO]    ğŸ“ Registro de huellas digitales (funciones originales)
2025-06-19 14:02:00,458 [INFO]    ğŸ” Control de acceso en tiempo real
2025-06-19 14:02:00,458 [INFO]    ğŸ“Š ValidaciÃ³n de membresÃ­as activas
2025-06-19 14:02:00,458 [INFO]    â° Restricciones de horarios
2025-06-19 14:02:00,458 [INFO]    ğŸšª Control automÃ¡tico de puertas
2025-06-19 14:02:00,458 [INFO]    ğŸ’¾ Registro completo en base de datos
2025-06-19 14:02:00,458 [INFO]    ğŸ”§ DeshabilitaciÃ³n del control interno del F22
2025-06-19 14:02:00,458 [INFO] 
2025-06-19 14:02:00,458 [INFO] âš ï¸  CORRECCIONES APLICADAS:
2025-06-19 14:02:00,459 [INFO]    âœ… Control de acceso interno del F22 deshabilitado
2025-06-19 14:02:00,459 [INFO]    âœ… Monitoreo de eventos con SSR_GetRTLog
2025-06-19 14:02:00,459 [INFO]    âœ… ValidaciÃ³n completa de membresÃ­as
2025-06-19 14:02:00,459 [INFO]    âœ… Manejo robusto de desconexiones
2025-06-19 14:02:00,459 [INFO] ================================================================================
2025-06-19 14:02:00,471 [INFO] server listening on 127.0.0.1:8082
2025-06-19 14:02:00,471 [INFO] âœ… Servidor WebSocket activo en ws://127.0.0.1:8082
2025-06-19 14:02:00,471 [INFO] â³ Esperando conexiones...
2025-06-19 14:02:41,453 [INFO] connection open
2025-06-19 14:02:41,454 [INFO] ğŸ”Œ [WS] Cliente conectado: 1263861882832
2025-06-19 14:02:41,455 [INFO] ğŸ¯ [MSG] AcciÃ³n recibida: connect_device
2025-06-19 14:02:41,455 [INFO] ğŸ”Œ [CONNECT] Conectando a F22 en 192.168.1.201:4370...
2025-06-19 14:02:42,427 [INFO] âœ… [ACCESS] Control de acceso del dispositivo deshabilitado (mÃ©todo 1)
2025-06-19 14:02:42,474 [INFO] âœ… [ACCESS] Modo verificaciÃ³n configurado (mÃ©todo 2)
2025-06-19 14:02:42,475 [INFO] âœ… [CONNECT] ConexiÃ³n exitosa con F22
2025-06-19 14:02:43,503 [INFO] HTTP Request: GET https://tyuuyqypgwvdtpfvumxx.supabase.co/rest/v1/access_control_config?select=%2A&limit=1 "HTTP/1.1 200 OK"
2025-06-19 14:02:43,504 [INFO] âœ… [CONFIG] Control de acceso: HABILITADO
2025-06-19 14:02:43,504 [INFO] ğŸ”„ [MONITOR] Iniciando control de acceso...
2025-06-19 14:02:43,591 [INFO] âœ… [MONITOR] Control de acceso activo
2025-06-19 14:02:43,591 [INFO] ğŸ”„ [EVENTS] Thread de monitoreo iniciado
2025-06-19 14:02:43,644 [INFO] ğŸ¯ [MSG] AcciÃ³n recibida: sync_template_from_db
2025-06-19 14:02:43,645 [INFO] ğŸ”„ [MSG] Iniciando sync_template_from_db para usuario 7265
2025-06-19 14:02:43,645 [INFO] ğŸ”„ [SYNC] Iniciando sincronizaciÃ³n de template desde BD...
2025-06-19 14:02:43,646 [INFO] ğŸ” [SYNC] Consultando nombre para usuario UUID: 67378a76-78dc-49d9-9864-83aef6754961
2025-06-19 14:02:43,646 [INFO] ğŸ” [SUPABASE] Consultando usuario: 67378a76-78dc-49d9-9864-83aef6754961
2025-06-19 14:02:43,688 [ERROR] âŒ [EVENTS] Error en monitoreo: '<win32com.gen_py.ZKEMKeeper 6.0 Control.IZKEM instance at 0x1263861884176>' object has no attribute 'SSR_GetRTLog'
2025-06-19 14:02:44,524 [INFO] HTTP Request: GET https://tyuuyqypgwvdtpfvumxx.supabase.co/rest/v1/Users?select=firstName%2ClastName&id=eq.67378a76-78dc-49d9-9864-83aef6754961 "HTTP/1.1 200 OK"
2025-06-19 14:02:44,525 [INFO] âœ… [SUPABASE] Nombre obtenido: 'MUP - Erick Francisco De Luna'
2025-06-19 14:02:44,526 [INFO] ğŸ”„ [SYNC] === DATOS DE SINCRONIZACIÃ“N ===
2025-06-19 14:02:44,526 [INFO] ğŸ‘¤ [SYNC] Usuario: 7265 - 'MUP - Erick Francisco De Luna'
2025-06-19 14:02:44,527 [INFO] ğŸ–ï¸ [SYNC] Dedo: Frontend 8 â†’ ZKTeco 7 (Medio Izquierdo)
2025-06-19 14:02:44,527 [INFO] ğŸ‘¤ [SYNC] Configurando usuario en F22...
2025-06-19 14:02:44,897 [ERROR] âŒ [EVENTS] Error en monitoreo: '<win32com.gen_py.ZKEMKeeper 6.0 Control.IZKEM instance at 0x1263861884176>' object has no attribute 'SSR_GetRTLog'
2025-06-19 14:02:45,470 [INFO] âœ… [SYNC] Usuario configurado en F22: MUP - Erick Francisco De Luna
2025-06-19 14:02:45,471 [INFO] ğŸ–ï¸ [SYNC] Guardando template de huella en F22...
2025-06-19 14:02:45,471 [INFO] ğŸ”§ [SYNC] MÃ©todo 1: SetUserTmpExStr...
2025-06-19 14:02:46,615 [ERROR] âŒ [EVENTS] Error en monitoreo: '<win32com.gen_py.ZKEMKeeper 6.0 Control.IZKEM instance at 0x1263861884176>' object has no attribute 'SSR_GetRTLog'
2025-06-19 14:02:46,662 [INFO] âœ… [SYNC] Template guardado exitosamente con SetUserTmpExStr
2025-06-19 14:02:46,662 [INFO] ğŸ”„ [SYNC] Refrescando datos del dispositivo...
2025-06-19 14:02:46,699 [INFO] âœ… [SYNC] Datos del dispositivo refrescados
2025-06-19 14:02:46,700 [INFO] ğŸ‰ [SYNC] === SINCRONIZACIÃ“N COMPLETADA EXITOSAMENTE ===
2025-06-19 14:02:46,703 [INFO] â„¹ï¸ [WS] No hay mÃ¡s clientes, desconectando del F22...
2025-06-19 14:02:47,616 [INFO] ğŸ”„ [EVENTS] Thread de monitoreo finalizado
2025-06-19 14:02:47,617 [INFO] ğŸ”Œ [DISCONNECT] Desconectando del F22...
2025-06-19 14:02:47,785 [INFO] âœ… [DISCONNECT] Desconectado de F22
2025-06-19 14:08:22,769 [INFO] server closing
2025-06-19 14:08:22,771 [INFO] server closed
2025-06-19 14:08:22,773 [INFO] â›” Servicio detenido por el usuario
2025-06-19 15:00:39,994 [INFO] ================================================================================
2025-06-19 15:00:39,994 [INFO] ğŸš€ SERVICIO UNIFICADO F22 - REGISTRO Y CONTROL DE ACCESO
2025-06-19 15:00:39,995 [INFO] ================================================================================
2025-06-19 15:00:39,995 [INFO] ğŸ“… VersiÃ³n: 3.1.0 FIXED - 2025-06-19 15:00:39.995245
2025-06-19 15:00:39,995 [INFO] ğŸ‘¤ Autor: luishdz04
2025-06-19 15:00:39,995 [INFO] ğŸŒ Puerto WebSocket: 8082
2025-06-19 15:00:39,995 [INFO] ğŸ¢ Dispositivo: 192.168.1.201:4370
2025-06-19 15:00:39,995 [INFO] ğŸŒ Zona horaria: America/Mexico_City
2025-06-19 15:00:39,995 [INFO] 
2025-06-19 15:00:39,995 [INFO] âœ… CARACTERÃSTICAS:
2025-06-19 15:00:39,995 [INFO]    ğŸ“ Registro de huellas digitales
2025-06-19 15:00:39,995 [INFO]    ğŸ” Control de acceso en tiempo real
2025-06-19 15:00:39,995 [INFO]    ğŸ“Š ValidaciÃ³n de membresÃ­as activas
2025-06-19 15:00:39,995 [INFO]    â° Restricciones de horarios
2025-06-19 15:00:39,995 [INFO]    ğŸšª Control automÃ¡tico de puertas
2025-06-19 15:00:39,995 [INFO]    ğŸ’¾ Registro completo en base de datos
2025-06-19 15:00:39,995 [INFO] 
2025-06-19 15:00:39,996 [INFO] ğŸ”§ IMPLEMENTACIÃ“N CORREGIDA:
2025-06-19 15:00:39,996 [INFO]    âœ… Thread dedicado para eventos COM
2025-06-19 15:00:39,996 [INFO]    âœ… DispatchWithEvents para eventos COM
2025-06-19 15:00:39,996 [INFO]    âœ… Aislamiento correcto de threads COM
2025-06-19 15:00:39,996 [INFO]    âœ… Cola de eventos asÃ­ncrona
2025-06-19 15:00:39,996 [INFO]    âœ… ValidaciÃ³n completa de accesos
2025-06-19 15:00:39,996 [INFO] ================================================================================
2025-06-19 15:00:40,007 [INFO] server listening on 127.0.0.1:8082
2025-06-19 15:00:40,008 [INFO] âœ… Servidor WebSocket activo en ws://127.0.0.1:8082
2025-06-19 15:00:40,008 [INFO] â³ Esperando conexiones...
2025-06-19 15:01:39,262 [INFO] connection open
2025-06-19 15:01:39,263 [INFO] ğŸ”Œ [WS] Cliente conectado: 2103488259680
2025-06-19 15:01:39,265 [INFO] ğŸ¯ [MSG] AcciÃ³n recibida: connect_device
2025-06-19 15:01:39,266 [INFO] ğŸ”Œ [CONNECT] Conectando a F22 en 192.168.1.201:4370...
2025-06-19 15:01:41,154 [INFO] HTTP Request: GET https://tyuuyqypgwvdtpfvumxx.supabase.co/rest/v1/access_control_config?select=%2A&limit=1 "HTTP/1.1 200 OK"
2025-06-19 15:01:41,156 [INFO] âœ… [CONFIG] Control de acceso: HABILITADO
2025-06-19 15:01:41,157 [INFO] âœ… [CONNECT] ConexiÃ³n administrativa exitosa con F22
2025-06-19 15:01:41,189 [INFO] ğŸ¯ [MSG] AcciÃ³n recibida: sync_template_from_db
2025-06-19 15:01:41,189 [INFO] ğŸ”„ [MSG] Iniciando sync_template_from_db para usuario 7265
2025-06-19 15:01:41,190 [INFO] ğŸ”„ [SYNC] Iniciando sincronizaciÃ³n de template desde BD...
2025-06-19 15:01:41,190 [INFO] ğŸ” [SYNC] Consultando nombre para usuario UUID: 67378a76-78dc-49d9-9864-83aef6754961
2025-06-19 15:01:41,190 [INFO] ğŸ” [SUPABASE] Consultando usuario: 67378a76-78dc-49d9-9864-83aef6754961
2025-06-19 15:01:42,224 [INFO] HTTP Request: GET https://tyuuyqypgwvdtpfvumxx.supabase.co/rest/v1/Users?select=firstName%2ClastName&id=eq.67378a76-78dc-49d9-9864-83aef6754961 "HTTP/1.1 200 OK"
2025-06-19 15:01:42,226 [INFO] âœ… [SUPABASE] Nombre obtenido: 'MUP - Erick Francisco De Luna'
2025-06-19 15:01:42,227 [INFO] ğŸ”„ [SYNC] === DATOS DE SINCRONIZACIÃ“N ===
2025-06-19 15:01:42,227 [INFO] ğŸ‘¤ [SYNC] Usuario: 7265 - 'MUP - Erick Francisco De Luna'
2025-06-19 15:01:42,228 [INFO] ğŸ–ï¸ [SYNC] Dedo: Frontend 8 â†’ ZKTeco 7 (Medio Izquierdo)
2025-06-19 15:01:42,274 [INFO] ğŸ‘¤ [SYNC] Configurando usuario en F22...
2025-06-19 15:01:42,555 [INFO] âœ… [SYNC] Usuario configurado en F22: MUP - Erick Francisco De Luna
2025-06-19 15:01:42,556 [INFO] ğŸ–ï¸ [SYNC] Guardando template de huella en F22...
2025-06-19 15:01:42,556 [INFO] ğŸ”§ [SYNC] MÃ©todo 1: SetUserTmpExStr...
2025-06-19 15:01:42,940 [INFO] âœ… [SYNC] Template guardado exitosamente con SetUserTmpExStr
2025-06-19 15:01:42,990 [INFO] ğŸ”„ [SYNC] Refrescando datos del dispositivo...
2025-06-19 15:01:43,042 [INFO] âœ… [SYNC] Datos del dispositivo refrescados
2025-06-19 15:01:43,042 [INFO] ğŸ‰ [SYNC] === SINCRONIZACIÃ“N COMPLETADA EXITOSAMENTE ===
2025-06-19 15:01:43,047 [INFO] â„¹ï¸ [WS] No hay mÃ¡s clientes, programando desconexiÃ³n...
2025-06-19 15:02:13,049 [INFO] â„¹ï¸ [AUTO] Desconectando por inactividad (30s)...
2025-06-19 15:02:13,050 [INFO] ğŸ”„ [MONITOR] Deteniendo monitoreo...
2025-06-19 15:02:13,050 [INFO] âœ… [MONITOR] Monitoreo detenido
2025-06-19 15:02:13,050 [INFO] ğŸ”Œ [DISCONNECT] Desconectando conexiÃ³n administrativa...
2025-06-19 15:02:13,218 [INFO] âœ… [DISCONNECT] Desconectado de F22
2025-06-19 15:08:15,955 [INFO] server closing
2025-06-19 15:08:15,955 [INFO] server closed
2025-06-19 15:08:15,957 [INFO] â›” Servicio detenido por el usuario
