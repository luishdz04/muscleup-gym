2025-06-20 00:36:01,324 [INFO] 
🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍
2025-06-20 00:36:01,325 [INFO] [STARTUP] SERVICIO F22 v5.1 OFICIAL CON VERIFICACIÓN PURA
2025-06-20 00:36:01,325 [INFO] 🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍
2025-06-20 00:36:01,325 [INFO] [INFO] 📅 Fecha/Hora: 2025-06-20 06:32:07 UTC
2025-06-20 00:36:01,325 [INFO] [INFO] 👤 Usuario: mupai555
2025-06-20 00:36:01,325 [INFO] [INFO] 🔒 Modo de seguridad: ULTRA_STRICT
2025-06-20 00:36:01,325 [INFO] [INFO] 🚫 Offline mode: False (FALSE = SEGURO)
2025-06-20 00:36:01,325 [INFO] [INFO] 🌐 Dispositivo F22: 192.168.1.201:4370
2025-06-20 00:36:01,325 [INFO] [INFO] 🎯 Puerto WebSocket: 8082
2025-06-20 00:36:01,325 [INFO] 
2025-06-20 00:36:01,325 [INFO] [FEATURES] 🛡️ CARACTERÍSTICAS OFICIALES:
2025-06-20 00:36:01,325 [INFO]    ✅ STA Thread para eventos COM REALES (OnAttTransactionEx)
2025-06-20 00:36:01,325 [INFO]    ✅ ZKEventHandler OFICIAL sin parámetros en constructor
2025-06-20 00:36:01,326 [INFO]    ✅ pythoncom.PumpMessages() para callbacks en tiempo real
2025-06-20 00:36:01,326 [INFO]    ✅ 👆 REGISTRO DE HUELLAS con formato MUP (firstName lastName)
2025-06-20 00:36:01,326 [INFO]    ✅ 🔐 Validación BULLETPROOF con tu esquema de BD
2025-06-20 00:36:01,326 [INFO]    ✅ 📋 fingerprint_templates -> Users -> user_memberships
2025-06-20 00:36:01,326 [INFO]    ✅ 📊 Logs automáticos en access_logs
2025-06-20 00:36:01,326 [INFO]    ✅ 🎯 Monitoreo en tiempo real con validación inmediata
2025-06-20 00:36:01,326 [INFO]    ✅ 🔍 MODO VERIFICACIÓN PURA - F22 NO da acceso automático
2025-06-20 00:36:01,326 [INFO]    ✅ 🔓 Z_ACUnlock - FUNCIÓN OFICIAL ZKTECO PARA ABRIR PUERTAS
2025-06-20 00:36:01,326 [INFO]    ✅ ⚡ ACUnlock, EnableDisableDevice, SetSysOption OFICIALES
2025-06-20 00:36:01,326 [INFO]    ✅ 🔧 Control directo de relé físico
2025-06-20 00:36:01,326 [INFO]    ✅ 🚨 SOFTWARE CONTROLA ACCESO - NO EL DISPOSITIVO
2025-06-20 00:36:01,326 [INFO]    ✅ 🔒 CERO tolerancia a errores de seguridad
2025-06-20 00:36:01,326 [INFO]    ✅ 🎮 WebSocket API completa SIN ERRORES
2025-06-20 00:36:01,326 [INFO]    ✅ 📚 FUNCIONES EXACTAS DE TU GUÍA ZKTECO
2025-06-20 00:36:01,326 [INFO] 🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍
2025-06-20 00:36:01,326 [INFO] [STARTUP] 🔗 Iniciando conexión F22 OFICIAL CON VERIFICACIÓN PURA...
2025-06-20 00:36:01,326 [INFO] [SERVICE] 🚀 Iniciando servicio F22 OFICIAL v5.1...
2025-06-20 00:36:01,326 [INFO] [VERIFY] 🔍 Verificando conexión a Supabase...
2025-06-20 00:36:02,780 [INFO] [VERIFY] ✅ Conexión a Supabase verificada
2025-06-20 00:36:02,781 [INFO] [STA_THREAD] 🧵 Thread STA OFICIAL inicializado
2025-06-20 00:36:02,782 [INFO] [STA_THREAD] ✅ COM inicializado en modo STA
2025-06-20 00:36:02,783 [INFO] [STA_THREAD] 🔗 Conectando a F22 OFICIAL en 192.168.1.201:4370
2025-06-20 00:36:03,510 [INFO] [STA_THREAD] ✅ Conectado al F22
2025-06-20 00:36:03,552 [INFO] [STA_THREAD] 📋 Info dispositivo: {'serial': 'BOCK192461543', 'firmware': 'Unknown', 'device_status': 'Unknown'}
2025-06-20 00:36:03,553 [INFO] [STA_THREAD] 🔧 APLICANDO CONFIGURACIÓN OFICIAL ZKTeco...
2025-06-20 00:36:03,790 [INFO] [SUCCESS] ✅ Servicio F22 OFICIAL iniciado
2025-06-20 00:36:03,791 [INFO] [OFICIAL] ✅ AutoOpenDoor = 0
2025-06-20 00:36:03,792 [INFO] [SUCCESS] 🔍 Eventos COM reales activos (VERIFICACIÓN PURA)
2025-06-20 00:36:03,793 [INFO] [SUCCESS] 👆 Registro de huellas activo
2025-06-20 00:36:03,794 [INFO] [SUCCESS] 🎯 Validación con tu BD activa
2025-06-20 00:36:03,795 [INFO] [SUCCESS] 🔓 Control de puerta con Z_ACUnlock OFICIAL
2025-06-20 00:36:03,796 [INFO] [SUCCESS] 🚨 F22 NO da acceso automático - SOFTWARE CONTROLA
2025-06-20 00:36:03,796 [INFO] [STARTUP] ✅ Conexión F22 OFICIAL establecida
2025-06-20 00:36:03,797 [INFO] [STARTUP] 🌐 Iniciando WebSocket F22 OFICIAL...
2025-06-20 00:36:03,815 [INFO] [SUCCESS] 🚀 Sistema F22 OFICIAL activo en puerto 8082
2025-06-20 00:36:03,815 [INFO] 
2025-06-20 00:36:03,816 [INFO] [READY] 🎯 Sistema listo - CON VERIFICACIÓN PURA OFICIAL
2025-06-20 00:36:03,816 [INFO] [READY] 🔍 Monitoreo en tiempo real con eventos COM
2025-06-20 00:36:03,816 [INFO] [READY] 👆 Registro de huellas (MUP format) listo
2025-06-20 00:36:03,816 [INFO] [READY] 📊 Logs automáticos en access_logs activos
2025-06-20 00:36:03,816 [INFO] [READY] 🔓 Control de puerta con Z_ACUnlock OFICIAL
2025-06-20 00:36:03,817 [INFO] [READY] 🚨 F22 configurado en MODO VERIFICACIÓN PURA
2025-06-20 00:36:03,817 [INFO] [READY] ⚡ SOFTWARE CONTROLA EL ACCESO - NO EL DISPOSITIVO
2025-06-20 00:36:03,817 [INFO] 
2025-06-20 00:36:03,817 [INFO] [IMPORTANT] 🧪 PRUEBA TODAS LAS FUNCIONALIDADES:
2025-06-20 00:36:03,817 [INFO]    1. 👤 Usuario CON membresía activa → SOFTWARE decide y abre puerta ✅
2025-06-20 00:36:03,817 [INFO]    2. ❌ Usuario SIN membresía → SOFTWARE deniega acceso (NO el F22)
2025-06-20 00:36:03,817 [INFO]    3. ❓ Usuario no registrado → SOFTWARE deniega acceso
2025-06-20 00:36:03,817 [INFO]    4. ⏰ Usuario fuera de horario → SOFTWARE deniega acceso
2025-06-20 00:36:03,817 [INFO]    5. 👆 Registrar nueva huella → Usar 'enroll_user'
2025-06-20 00:36:03,818 [INFO]    6. 📊 Verificar logs en access_logs automáticamente
2025-06-20 00:36:03,818 [INFO]    7. 🔓 Probar apertura manual → Usar 'open_door' (Z_ACUnlock)
2025-06-20 00:36:03,818 [INFO] 
2025-06-20 00:36:03,818 [INFO] [WEBSOCKET] 🌐 API OFICIAL disponible en:
2025-06-20 00:36:03,818 [INFO]    ws://127.0.0.1:8082
2025-06-20 00:36:03,818 [INFO] 
2025-06-20 00:36:03,818 [INFO] [API] 🎮 Acciones disponibles:
2025-06-20 00:36:03,818 [INFO]    - get_device_info: Info del dispositivo + funciones disponibles
2025-06-20 00:36:03,818 [INFO]    - test_access: Probar validación de usuario
2025-06-20 00:36:03,818 [INFO]    - open_door: Abrir puerta con Z_ACUnlock (OFICIAL)
2025-06-20 00:36:03,819 [INFO]    - enroll_user: Registrar huella (requiere user_data)
2025-06-20 00:36:03,819 [INFO]    - get_enrollment_status: Estado del registro
2025-06-20 00:36:03,819 [INFO]    - connect_device: Conectar dispositivo
2025-06-20 00:36:03,819 [INFO]    - disconnect_device: Desconectar dispositivo
2025-06-20 00:36:03,819 [INFO]    - get_service_status: Estado completo del servicio
2025-06-20 00:36:03,819 [INFO] 
2025-06-20 00:36:03,819 [INFO] 🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍
2025-06-20 00:36:03,819 [INFO] [STATUS] ✅ SISTEMA F22 OFICIAL CON VERIFICACIÓN PURA ACTIVO
2025-06-20 00:36:03,820 [INFO] [STATUS] 👆 PON TU DEDO EN EL F22 PARA PROBAR VERIFICACIÓN PURA
2025-06-20 00:36:03,820 [INFO] [STATUS] 🔍 F22 SOLO VERIFICA - SOFTWARE DECIDE ACCESO
2025-06-20 00:36:03,820 [INFO] [STATUS] 🔓 LA PUERTA SOLO SE ABRE SI SOFTWARE LO AUTORIZA
2025-06-20 00:36:03,820 [INFO] [STATUS] 📝 USA API WEBSOCKET PARA REGISTRAR HUELLAS
2025-06-20 00:36:03,820 [INFO] [STATUS] 📚 FUNCIONES OFICIALES ZKTECO UTILIZADAS
2025-06-20 00:36:03,820 [INFO] 🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍🔍
2025-06-20 00:36:03,994 [INFO] [OFICIAL] ✅ VerifyMode = 1
2025-06-20 00:36:04,235 [INFO] [OFICIAL] ✅ AutoBell = 0
2025-06-20 00:36:04,283 [INFO] [OFICIAL] ✅ LockOn = 0
2025-06-20 00:36:04,331 [INFO] [OFICIAL] ✅ MThreshold = 0
2025-06-20 00:36:04,391 [INFO] [OFICIAL] ✅ AttState = 255
2025-06-20 00:36:04,426 [INFO] [OFICIAL] ✅ WorkCode = 0
2025-06-20 00:36:04,521 [INFO] [OFICIAL] ✅ Realtime = 1
2025-06-20 00:36:04,616 [INFO] [OFICIAL] ✅ TransFlag = 0000000000
2025-06-20 00:36:04,713 [INFO] [OFICIAL] ✅ TransInterval = 0
2025-06-20 00:36:04,807 [INFO] [OFICIAL] ✅ RFCardOn = 0
2025-06-20 00:36:04,871 [INFO] [OFICIAL] ✅ NetworkOn = 0
2025-06-20 00:36:04,967 [INFO] [OFICIAL] ✅ AutoUpdate = 0
2025-06-20 00:36:05,062 [INFO] [OFICIAL] ✅ Encrypt = 0
2025-06-20 00:36:05,157 [INFO] [OFICIAL] ✅ MultiVerify = 0
2025-06-20 00:36:05,205 [INFO] [OFICIAL] ✅ FaceFunOn = 0
2025-06-20 00:36:05,301 [INFO] [OFICIAL] ✅ AlarmAttLog = 0
2025-06-20 00:36:05,396 [INFO] [OFICIAL] ✅ AlarmOpLog = 0
2025-06-20 00:36:05,444 [INFO] [OFICIAL] ✅ UseDoorSensor = 0
2025-06-20 00:36:05,540 [INFO] [OFICIAL] ✅ DoorDelay = 0
2025-06-20 00:36:05,594 [INFO] [OFICIAL] ✅ LockDelay = 0
2025-06-20 00:36:05,634 [INFO] [OFICIAL] ✅ Dispositivo ACTIVO para lectura (EnableDevice)
2025-06-20 00:36:05,733 [INFO] [OFICIAL] ✅ Configurado como VERIFICADOR PURO
2025-06-20 00:36:05,778 [INFO] [OFICIAL] ✅ Configuración refrescada
2025-06-20 00:36:05,779 [INFO] [OFICIAL] ✅ Configuración aplicada: 24 opciones
2025-06-20 00:36:05,779 [INFO] [OFICIAL] 🔍 F22 configurado como VERIFICADOR (NO auto-acceso)
2025-06-20 00:36:05,780 [INFO] [OFICIAL] ⚡ Control de puerta: MANUAL con Z_ACUnlock
2025-06-20 00:36:05,780 [INFO] [OFICIAL] 🔍 Verificando funciones disponibles...
2025-06-20 00:36:05,781 [INFO] [OFICIAL] 📋 Funciones disponibles: 13/17
2025-06-20 00:36:05,822 [INFO] [STA_THREAD] ✅ Eventos COM registrados (OFICIAL)
2025-06-20 00:36:05,823 [INFO] [STA_THREAD] 🚀 Monitoreo OFICIAL con eventos COM activo
2025-06-20 00:36:05,823 [INFO] [STA_THREAD] 🔍 F22 configurado en MODO VERIFICACIÓN PURA
2025-06-20 00:36:05,824 [INFO] [STA_THREAD] 🔓 Control de puerta con Z_ACUnlock OFICIAL
2025-06-20 00:36:05,824 [INFO] [FINGERPRINT] 🔧 Inicializando gestor de huellas...
2025-06-20 00:36:06,775 [INFO] [FINGERPRINT] 📋 Cargando usuarios del dispositivo...
2025-06-20 00:36:06,823 [INFO] [FINGERPRINT] ✅ 0 usuarios cargados
2025-06-20 00:36:08,003 [INFO] [FINGERPRINT] ✅ Gestor inicializado - Próximo ID: 7266
2025-06-20 00:36:08,004 [INFO] [STA_THREAD] ✅ Fingerprint manager inicializado
2025-06-20 00:36:08,004 [INFO] [STA_THREAD] 🔄 Iniciando loop STA OFICIAL
2025-06-20 00:36:17,785 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:36:32,791 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:36:47,794 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:37:02,796 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:37:17,804 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:37:32,806 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:37:47,810 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:38:02,817 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:38:17,819 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:38:32,824 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:38:47,831 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:39:02,837 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:39:17,840 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:39:32,849 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:39:47,858 [WARNING] [STA_THREAD] ⚠️ Heartbeat falló
2025-06-20 00:39:57,500 [INFO] [SHUTDOWN] 🛑 Iniciando apagado OFICIAL (SIGINT)
2025-06-20 00:39:57,501 [INFO] [STA_THREAD] 🧹 Limpiando recursos OFICIALES...
2025-06-20 00:39:57,677 [INFO] [STA_THREAD] ✅ Recursos OFICIALES liberados
2025-06-20 00:39:57,678 [INFO] [STA_THREAD] 🧵 Thread STA OFICIAL finalizado
2025-06-20 00:39:58,025 [INFO] [SHUTDOWN] 🛑 Cerrando WebSocket F22 OFICIAL...
2025-06-20 00:39:58,026 [INFO] [SERVICE] 🛑 Deteniendo servicio OFICIAL...
2025-06-20 00:39:58,027 [INFO] [SERVICE] ✅ Servicio OFICIAL detenido
2025-06-20 00:39:58,027 [INFO] [SHUTDOWN] ✅ Sistema F22 OFICIAL cerrado limpiamente
2025-06-20 00:39:58,033 [INFO] [SHUTDOWN] 🧹 Limpiando recursos OFICIALES...
2025-06-20 00:39:58,033 [INFO] [SHUTDOWN] ✅ Recursos OFICIALES liberados
